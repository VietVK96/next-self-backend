<style>
    @page {
      size: A4;
      margin: 0;
      padding: 0;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        font-size: 9pt;
    }

    table th,
    table td {
        vertical-align: top;
        padding: 2mm 2mm;
    }

    table.bordered th,
    table.bordered td {
        border: 0.1pt solid #000000;
    }

    table thead th {
        text-align: center;
    }

    table td.paymentDate {
        width: 13%;
        text-align: center;
    }

    table td.entryDate {
        width: 13%;
        text-align: center;
    }

    table td.payer {
        width: 32%;
    }

    table td.paymentMode {
        width: 12%;
        text-align: center;
    }

    table td.amount {
        width: 10%;
        text-align: right;
    }

    table td.amountCare {
        width: 10%;
        text-align: right;
    }

    table td.amountProsthesis {
        width: 10%;
        text-align: right;
    }

    table td.amountTotalLabel {
        width: 70%;
        text-align: right;
    }

    table td.amountTotal {
        width: 10%;
        text-align: right;
    }

    table td.amountCareTotal {
        width: 10%;
        text-align: right;
    }

    table td.amountProsthesisTotal {
        width: 10%;
        text-align: right;
    }

    table tr.tfoot {
        font-weight: bold;
    }

    table.total th,
    table.total td {
        padding: 1mm 2mm;
    }

    </style>

    <page>
      {{#if groupValid}}
<table class="bordered" style="margin-bottom: 5mm; table-layout: fixed;">
    <thead>
        <tr>
            <th>Date d'échéance</th>
            <th>sinh</th>
            {{#each paymentMethods}}
            <th>{{PaymentMethodEnum.getReadableValue this}}</th>
            {{/each}}
            <th>Montant</th>
        </tr>
    </thead>
    <tbody>
        {{#each byDay}}
        <tr>
            <td style="text-align: center;">{{this.[0]}}</td>
            {{#each paymentMethods}}
            <td style="text-align: right;">{{@key}}: {{this}}</td>
            {{/each}}
            <td style="text-align: right;">{{this.total}}</td>
        </tr>
        {{/each}}
        <tr class="tfoot">
            <th>Total</th>
            {{#each ../paymentMethods}}
            <td style="text-align: right;">{{this.amount}}</td>
            {{/each}}
            <td style="text-align: right;">{{this.total.total}}</td>
        </tr>
    </tbody>
</table>
<table class="total">
    <tbody>
        {{#each paymentTypes}}
        {{#if (or ../total.[this].amount 0)}}
        <tr>
            <td class="amountTotalLabel" style="text-align: right;"><strong>{{PaymentTypeEnum.getReadableValue this}}</strong></td>
            <td class="amountTotal">{{this.total}}</td>
        </tr>
        {{/if}}
        {{/each}}
    </tbody>
</table>
{{else}}
<table class="bordered" style="margin-bottom: 5mm;">
    <thead>
        <tr>
            <th class="paymentDate"> Date d'échéance</th>
            <th class="entryDate"> Date de saisie</th>
            <th class="payer"> Partie versante</th>
            <th class="paymentMode"> Mode</th>
            <th class="amount"> Montant</th>
            <th class="amountCare"> Soins</th>
            <th class="amountProsthesis"> Prothèses</th>
        </tr>
    </thead>
    <tbody>
        {{#each payments}}
        <tr>
            <td class="paymentDate">{{paymentDate}}</td>
            <td class="entryDate">{{date}}</td>
            <td class="payer">{{payer}}</td>
            <td class="paymentMode">{{PaymentMethodEnum.getReadableValue payment}}</td>
            <td class="amount">{{this.amount}}</td>
            <td class="amountCare">{{this.amount_care}}</td>
            <td class="amountProsthesis">{{this.amount_prosthesis}}</td>
        </tr>
        {{/each}}
        <tr class="tfoot">
            <td colspan="4" style="text-align: right;"> Total</td>
            <td class="amountTotal">{{this.total.amount}}</td>
            <td class="amountCareTotal">{{this.total.amountCare}}</td>
            <td class="amountProsthesisTotal">{{this.total.amountProsthesis}}</td>
        </tr>
    </tbody>
</table>
<table class="total">
    <tbody>
        {{#each paymentMethods}}
        {{#if (or total.[this].amount 0)}}
        <tr>
            <td class="amountTotalLabel"><strong>{{PaymentMethodEnum.getReadableValue this}}</strong></td>
            <td class="amountTotal">{{this.amount}}</td>
            <td class="amountCareTotal">{{this.amountCare}}</td>
            <td class="amountProsthesisTotal">{{this.amountProsthesis}}</td>
        </tr>
        {{/if}}
        {{/each}}
        {{#each paymentTypes}}
        {{#if (or total.[this].amount)}}
        <tr>
            <td class="amountTotalLabel"><strong>{{PaymentTypeEnum.getReadableValue this}}</strong></td>
            <td class="amountTotal">{{this.amount}}</td>
            <td class="amountCareTotal">{{this.amountCare}}</td>
            <td class="amountProsthesisTotal">{{this.amountProsthesis}}</td>
        </tr>
        {{/if}}
        {{/each}}
    </tbody>
</table>
{{/if}}
    </page>